<form [formGroup]="formGroup" (ngSubmit)="onSubmit()" class="inventory-form">
    <div class="form-section image-upload-section">
        <label class="section-label">Product Images</label>

        <div class="upload-area">
            <input
                type="file"
                #fileInput
                multiple
                accept="image/*"
                (change)="onFileSelect($event)"
                class="file-input"
                id="file-upload"
            />
            <label for="file-upload" class="upload-label">
                <mat-icon>cloud_upload</mat-icon>
                <span>Click to upload images</span>
                <span class="upload-hint">or drag and drop</span>
            </label>
        </div>

        @if (previewUrls().length > 0) {
            <div class="image-previews">
                @for (url of previewUrls(); track url; let i = $index) {
                    <div class="preview-item">
                        <img [src]="url" alt="Preview" />
                        <button
                            type="button"
                            mat-icon-button
                            class="remove-btn"
                            (click)="removeImage(i)"
                        >
                            <mat-icon>close</mat-icon>
                        </button>
                    </div>
                }
            </div>
        }
    </div>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Product Title</mat-label>
        <input
            matInput
            formControlName="title"
            placeholder="e.g., Custom Oak Dining Table"
        />
        @if (
            formGroup.get("title")?.invalid && formGroup.get("title")?.touched
        ) {
            <mat-error>{{ getErrorMessage("title") }}</mat-error>
        }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea
            matInput
            formControlName="description"
            rows="5"
            placeholder="Describe your product..."
        ></textarea>
        @if (
            formGroup.get("description")?.invalid &&
            formGroup.get("description")?.touched
        ) {
            <mat-error>{{ getErrorMessage("description") }}</mat-error>
        }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
        <mat-label>Price</mat-label>
        <span matPrefix>$&nbsp;</span>
        <input
            matInput
            type="number"
            formControlName="price"
            placeholder="0.00"
            step="0.01"
        />
        @if (
            formGroup.get("price")?.invalid && formGroup.get("price")?.touched
        ) {
            <mat-error>{{ getErrorMessage("price") }}</mat-error>
        }
    </mat-form-field>

    <div class="form-actions">
        <button
            mat-raised-button
            color="primary"
            type="submit"
            class="submit-btn"
            [disabled]="formGroup.invalid"
        >
            Add Product
        </button>
    </div>
</form>
