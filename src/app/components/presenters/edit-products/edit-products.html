@if (selectedProducts.size > 0) {
    <div class="header-actions">
        <button
            matButton="filled"
            (click)="onDeleteSelected()"
            class="bulk-delete-btn"
        >
            Delete Selected ({{ selectedProducts.size }})
        </button>
    </div>
}

<div class="products-container">
    @for (product of products; track product.id) {
        <mat-card appearance="outlined" class="product-card">
            <div class="card-header">
                <mat-checkbox
                    [checked]="selectedProducts.has(product.id)"
                    (change)="toggleSelection(product.id)"
                    (click)="$event.stopPropagation()"
                    class="product-checkbox"
                ></mat-checkbox>
                <button
                    mat-icon-button
                    color="warn"
                    class="delete-btn"
                    (click)="
                        onDeleteProduct(product.id); $event.stopPropagation()
                    "
                    title="Delete {{ product.name }}"
                >
                    <span class="delete-icon">âœ•</span>
                </button>
            </div>

            <div class="image-container">
                <img
                    mat-card-image
                    [src]="getCurrentImageUrl(product)"
                    alt="{{ product.name }}"
                    class="product-image"
                />
                @if (hasMultipleImages(product)) {
                    <button
                        mat-icon-button
                        class="nav-button prev-button"
                        (click)="previousImage(product.id, product, $event)"
                        title="Previous image"
                    >
                        <mat-icon>chevron_left</mat-icon>
                    </button>
                    <button
                        mat-icon-button
                        class="nav-button next-button"
                        (click)="nextImage(product.id, product, $event)"
                        title="Next image"
                    >
                        <mat-icon>chevron_right</mat-icon>
                    </button>
                }
            </div>
            <mat-card-title>{{ product.name }}</mat-card-title>
            <mat-card-subtitle class="price"
                >${{ product.price }}</mat-card-subtitle
            >

            <mat-card-actions class="card-actions">
                <button
                    mat-raised-button
                    color="primary"
                    [routerLink]="['/update-inventory/edit', product.id]"
                    title="Edit {{ product.name }}"
                >
                    Edit
                </button>
            </mat-card-actions>
        </mat-card>
    }
</div>
<router-outlet></router-outlet>
